--// SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer

--// VARIABLES
local flying = false
local flySpeed = 10  -- başlangıç hızı (10 daha iyi)
local maxSpeed = 50

local bg, bv
local connection
local upPressed = false
local downPressed = false

--// GUI (SupermanFlyV8 tabanlı, UP/DOWN eklendi)
local ScreenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
ScreenGui.Name = "SupermanFlyV8"
ScreenGui.ResetOnSpawn = false

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0,240,0,300)  -- biraz büyüttüm UP/DOWN için
Main.Position = UDim2.new(0.5,-120,0.15,0)
Main.BackgroundColor3 = Color3.fromRGB(15,15,15)
Main.Active = true
Main.Draggable = true
Instance.new("UICorner", Main)

local Stroke = Instance.new("UIStroke", Main)
Stroke.Thickness = 3

local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1,0,0,35)
Title.BackgroundTransparency = 1
Title.Text = "SUPERMAN FLY V8"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 16
Title.TextColor3 = Color3.new(1,1,1)

local Toggle = Instance.new("TextButton", Main)
Toggle.Size = UDim2.new(0.8,0,0,40)
Toggle.Position = UDim2.new(0.1,0,0.2,0)  -- konum kaydı
Toggle.Text = "FLY: OFF"
Toggle.Font = Enum.Font.GothamBold
Toggle.TextSize = 16
Toggle.BackgroundColor3 = Color3.fromRGB(30,30,30)
Toggle.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", Toggle)

-- UP BUTTON
local UpBtn = Instance.new("TextButton", Main)
UpBtn.Size = UDim2.new(0.35,0,0,30)
UpBtn.Position = UDim2.new(0.1,0,0.4,0)
UpBtn.Text = "UP"
UpBtn.Font = Enum.Font.GothamBold
UpBtn.TextSize = 16
UpBtn.BackgroundColor3 = Color3.fromRGB(79, 255, 152)
UpBtn.TextColor3 = Color3.new(0,0,0)
Instance.new("UICorner", UpBtn)

-- DOWN BUTTON
local DownBtn = Instance.new("TextButton", Main)
DownBtn.Size = UDim2.new(0.35,0,0,30)
DownBtn.Position = UDim2.new(0.55,0,0.4,0)
DownBtn.Text = "DOWN"
DownBtn.Font = Enum.Font.GothamBold
DownBtn.TextSize = 16
DownBtn.BackgroundColor3 = Color3.fromRGB(215, 255, 121)
DownBtn.TextColor3 = Color3.new(0,0,0)
Instance.new("UICorner", DownBtn)

local SpeedLabel = Instance.new("TextLabel", Main)
SpeedLabel.Size = UDim2.new(1,0,0,30)
SpeedLabel.Position = UDim2.new(0,0,0.55,0)
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.Font = Enum.Font.GothamBold
SpeedLabel.TextSize = 15
SpeedLabel.TextColor3 = Color3.new(1,1,1)
SpeedLabel.Text = "SPEED: "..flySpeed

local SpeedUp = Instance.new("TextButton", Main)
SpeedUp.Size = UDim2.new(0.35,0,0,30)
SpeedUp.Position = UDim2.new(0.1,0,0.65,0)
SpeedUp.Text = "+"
SpeedUp.Font = Enum.Font.GothamBold
SpeedUp.TextSize = 18
SpeedUp.BackgroundColor3 = Color3.fromRGB(40,40,40)
SpeedUp.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", SpeedUp)

local SpeedDown = Instance.new("TextButton", Main)
SpeedDown.Size = UDim2.new(0.35,0,0,30)
SpeedDown.Position = UDim2.new(0.55,0,0.65,0)
SpeedDown.Text = "-"
SpeedDown.Font = Enum.Font.GothamBold
SpeedDown.TextSize = 18
SpeedDown.BackgroundColor3 = Color3.fromRGB(40,40,40)
SpeedDown.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", SpeedDown)

-- HELP BUTTON
local HelpBtn = Instance.new("TextButton", Main)
HelpBtn.Size = UDim2.new(0.3,0,0,28)
HelpBtn.Position = UDim2.new(0.35,0,0.82,0)
HelpBtn.Text = "?"
HelpBtn.Font = Enum.Font.GothamBold
HelpBtn.TextSize = 16
HelpBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
HelpBtn.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", HelpBtn)

local HelpFrame = Instance.new("Frame", ScreenGui)
HelpFrame.Size = UDim2.new(0,260,0,200)
HelpFrame.Position = UDim2.new(0.5,-130,0.5,-100)
HelpFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
HelpFrame.Visible = false
Instance.new("UICorner", HelpFrame)

local HelpText = Instance.new("TextLabel", HelpFrame)
HelpText.Size = UDim2.new(1,-10,1,-10)
HelpText.Position = UDim2.new(0,5,0,5)
HelpText.BackgroundTransparency = 1
HelpText.Font = Enum.Font.Gotham
HelpText.TextSize = 14
HelpText.TextColor3 = Color3.new(1,1,1)
HelpText.TextWrapped = true
HelpText.Text =
[[NASIL ÇALIŞIR

FLY ON → uçuş başlar
FLY OFF → kapanır

W → ileri
S → geri
A → sol
D → sağ

UP/DOWN butonları ile yüksel/alçal
(butonları basılı tut)

Speed + - ile hız değişir

Koltukta otursan bile uçarsın
(araba dahil)

Paneli sürükleyebilirsin]]

-- RGB EFFECT
task.spawn(function()
	local hue = 0
	while true do
		hue += 0.01
		if hue > 1 then hue = 0 end
		local color = Color3.fromHSV(hue,1,1)
		Stroke.Color = color
		Title.TextColor3 = color
		task.wait(0.03)
	end
end)

-- HELP TOGGLE
HelpBtn.MouseButton1Click:Connect(function()
	HelpFrame.Visible = not HelpFrame.Visible
end)

-- GET SEAT OR ROOT (R6/R15 uyumlu)
local function getFlyPart(char)
	-- Önce HumanoidRootPart dene
	local root = char:FindFirstChild("HumanoidRootPart")
	if root then return root end
	-- Yoksa Torso veya UpperTorso dene
	return char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
end

-- START FLY (yeni mekanik)
local function startFly()
	local char = LocalPlayer.Character
	if not char then return end

	local hum = char:FindFirstChildWhichIsA("Humanoid")
	if not hum then return end

	local root = getFlyPart(char)
	if not root then return end

	-- PlatformStand aktif et
	if not hum.SeatPart then
		hum.PlatformStand = true
	end

	-- BodyGyro: yumuşak dönüş
	bg = Instance.new("BodyGyro", root)
	bg.P = 5000  -- daha yumuşak
	bg.MaxTorque = Vector3.new(9e9,9e9,9e9)

	-- BodyVelocity: hareket
	bv = Instance.new("BodyVelocity", root)
	bv.MaxForce = Vector3.new(9e9,9e9,9e9)

	connection = RunService.RenderStepped:Connect(function()
		local cam = workspace.CurrentCamera
		if not cam then return end

		-- Kameraya dön
		bg.CFrame = cam.CFrame

		-- WASD hareketi
		local move = hum.MoveDirection
		local velocity = Vector3.zero

		if move.Magnitude > 0 then
			velocity = (cam.CFrame.LookVector * move.Z + cam.CFrame.RightVector * move.X) * flySpeed
		end

		-- UP/DOWN butonları
		if upPressed then
			velocity = velocity + Vector3.new(0, flySpeed, 0)
		end
		if downPressed then
			velocity = velocity + Vector3.new(0, -flySpeed, 0)
		end

		bv.Velocity = velocity
	end)
end

-- STOP FLY
local function stopFly()
	local char = LocalPlayer.Character
	if char then
		local hum = char:FindFirstChildWhichIsA("Humanoid")
		if hum then
			hum.PlatformStand = false
		end
	end

	if connection then connection:Disconnect() end
	if bg then bg:Destroy() end
	if bv then bv:Destroy() end
end

-- TOGGLE
local function toggleFly()
	flying = not flying
	
	if flying then
		Toggle.Text = "FLY: ON"
		startFly()
	else
		Toggle.Text = "FLY: OFF"
		stopFly()
	end
end

Toggle.MouseButton1Click:Connect(toggleFly)

-- UP BUTTON (basılı tut)
UpBtn.MouseButton1Down:Connect(function()
	upPressed = true
end)
UpBtn.MouseButton1Up:Connect(function()
	upPressed = false
end)
UpBtn.MouseLeave:Connect(function()
	upPressed = false
end)

-- DOWN BUTTON
DownBtn.MouseButton1Down:Connect(function()
	downPressed = true
end)
DownBtn.MouseButton1Up:Connect(function()
	downPressed = false
end)
DownBtn.MouseLeave:Connect(function()
	downPressed = false
end)

-- SPEED
SpeedUp.MouseButton1Click:Connect(function()
	flySpeed = math.min(flySpeed + 1, maxSpeed)
	SpeedLabel.Text = "SPEED: "..flySpeed
end)

SpeedDown.MouseButton1Click:Connect(function()
	if flySpeed > 1 then
		flySpeed = flySpeed - 1
	end
	SpeedLabel.Text = "SPEED: "..flySpeed
end)

-- RESPAWN FIX
LocalPlayer.CharacterAdded:Connect(function()
	stopFly()
	flying = false
	Toggle.Text = "FLY: OFF"
	upPressed = false
	downPressed = false
end)
